
<div class="container">
  <div class="calender-header">
    <h1>Your Calendar:</h1>
  </div class="calendar-box">
  <%= month_calendar(events: @meetups_accepted) do |date, meetups| %>

    <%= date.strftime("%d") %>
    <% meetups.each do |meetup| %>
      <% if meetup.user_two == current_user %>
        <% user_one = meetup.user_one %>
      <% else %>
        <% user_one = meetup.user_two %>
      <% end %>
        <%= render partial: "meetup_modal", locals: { user_one: user_one, meetup: meetup } %>
    <% end %>
  <% end %>
  <% if @meetups_accepted.length > 0 %>
  <div class="gymally-semibold">Upcoming:</div>
    <% @meetups_accepted.each do |meetup| %>
      <% if meetup.user_two == current_user %>
        <% user_one = meetup.user_one %>
      <% else %>
        <% user_one = meetup.user_two %>
      <% end %>
      <div class="meetup-info">
        <div><%= meetup.sport.name %> with <%= user_one.first_name %></div>
        <div><%= meetup.date.strftime("%a, %d %m %Y, %H:%M") %></div>
        <%= render partial: "user_modal", locals: { user_one: user_one, meetup: meetup } %>
      </div>
      <div>
        <%= link_to 'Cancel', friendship_delete_meetup_path(meetup.friendship, meetup), method: :delete, data: { confirm: "Are You sure you want to cancel this meetup?" } %>
      </div>
    <% end %>
  <% end %>
  <% if @meetups_requests.length > 0 %>
  <div class="gymally-semibold">Meetup requests from you:</div>
    <% @meetups_requests.each do |meetup| %>
      <% if meetup.user_two == current_user %>
        <% user_one = meetup.user_one %>
      <% else %>
        <% user_one = meetup.user_two %>
      <% end %>
      <p>to </p><%= user_one.first_name %> on the <%= meetup.date.strftime("%a, %d %m %Y, %H:%M") %><%= meetup.sport.name %>
              <%= render partial: "user_modal", locals: { user_one: user_one, meetup: meetup } %>
      <%= link_to 'Cancel', friendship_delete_meetup_path(meetup.friendship, meetup),
              method: :delete,
              data: { confirm: "Are You sure you want to cancel this meetup?" } %>
    <% end %>
  <% end %>
  <% if @meetups_invitations.length > 0 %>
  <div class="gymally-semibold">Meetup invitations for you:</div>
    <div id="invitation-card-container">
      <% @meetups_invitations.each do |meetup| %>
        <% if meetup.user_two == current_user %>
          <% user_one = meetup.user_one %>
        <% else %>
          <% user_one = meetup.user_two %>
        <% end %>
        <div class="invitation-card" >
          <%= image_tag user_one.photo, class: "avatar-small avatar-bordered" %>
          <div class="invitation-card-right">
            <div class="invitation-card-top">
              <div class="invitation-card-name gymally-semibold">
                  <%= user_one.first_name %> <%= render partial: "user_modal", locals: { user_one: user_one, meetup: meetup } %><div class="tag gymally-tag"><%= meetup.sport.name %></div>
              </div>
              <div class="deny-and-accept">
                <%= link_to "Accept", friendship_update_meetup_path(meetup.friendship, meetup), method: :post %>
                <%= link_to "Deny", friendship_delete_meetup_path(meetup.friendship, meetup), method: :delete,
                          data: { confirm: 'Are You sure?' } %>
              </div>
            </div>
            <div class="invitation-card-bottom gymally-small">
              <%= meetup.date.strftime("%a, %d %m %Y, %H:%M") %>
            </div>
          </div>
      <% end %>
    </div>
  <% end %>
</div>
